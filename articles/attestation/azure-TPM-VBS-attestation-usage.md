---
title: Azure TPM VBS Attestation usage 
description: Learn about how to leverage TPM and VBS attestation
services: attestation
author: prsriva
ms.service: attestation
ms.topic: overview
ms.date: 09/05/2022
ms.author: prsriva
ms.custom: tpm attestation
---

# Using TPM/VBS attestation 

Attestation can be integrated into vairous applications and servies, catering to different use cases. Azure Attestation service which acts the remote attestation service can be used for desired purposes by updating the attestation policy. The policy engine works as processor which takes the incoming payload as evidence and performs the validations as authored in the policy. This simplifies the workflow and enables the service owner to purpose build solutions for the varied platforms and use cases.The workflow remains the same as described in [Azure attestation workflow](workflow.md). For different purposes the attestaiton policy to be used is different.

Attesting a platform has its own challenges with its varied components of boot and setup, one needs to rely on a  hardware root-of-trust anchor that can be used to verify the very first steps of the boot process and extend that trust upward into every layer on your system. A hardware TPM provides such an anchor for a true remote attestation solution. Azure Attestation provides a highly scalable measured boot and runtime integrity measurement attestation solution with a revocation framework to give you full control over platform attestation and remediation.

## Attestation Steps

Attestation Setup has 2 setup. One pertaining to the service setup and one pertaining to the client setup.

:::image type="content" source="./media/tpm_attestation_setup.png" alt-text="A diagram that shows the different interactions for attestation." lightbox="./media/tpm_attestation_setup.png":::

Detailed information about the workflow is described in [Azure attestation workflow](workflow.md)

### Service endpoint setup:
This is the first step for any attestaiton to be performed. Setting up an endpoint, this can be performed either via code or using the Azure Portal.

Here is how you can setup an attestation endpoint using Portal
<ul>
<li> Prerequisite: Access to the AAD tenant and subscription under which you want to create the attestation endpoint.</li>
<li> Create an endpoint under the desired resource group, with the desired name.
![](creatingtpmendpoint.mp4)</li>
<li> Add Attestation Contributor Role to the Identity who will be responsible to update the attestation policy.
![](addroletoendpoint.mp4)</li>
<li> Configure the endpoint with the required policy.
![](configurepolicy.mp4)</li>
Sample policies can be found in the [Policy Samples](tpm-attestation-sample-policies.md) Section.</br>

> [!NOTE]
> Note: TPM endpoints are designed to be provisioned without a default attestation policy.
</ul>


### Client Setup:
A client to communicate with the attestation service endpoint needs to ensure it is following the protocol as described in the [procotol documentation](virtualization-based-security-protocol.md). Use the [Attestation Client NuGet](https://www.nuget.org/packages/Microsoft.Attestation.Client) to ease the integration.

<ul>
<li> Add Attestation Reader Role to the identity that will be used for authentication against the endpoint.
![](addreaderrole.mov)</li>
</ul>

## Execute the Attestation Workflow:
Using the [Client](https://github.com/microsoft/Attestation-Client-Samples) trigger an attestation flow. A successful atttestation will result in an attestation report.Parsing the JWT token, the contents of the report can be easily validated against expected outcome. 
Here is a sample of the contents of the attestation report.
<Add decoded report image>

Using the Open ID [metadata endpoint](https://learn.microsoft.com/en-us/rest/api/attestation/metadata-configuration/get?tabs=HTTP) contains properties which describe the attestation service.The signing keys describe the keys which will be used to sign tokens generated by the attestation service. All tokens emitted by the attestation service will be signed by one of the certificates listed in the attestation signing keys.

## Learn More about integration and support