---
title: Enable vulnerability assessment on your Azure SQL databases using Microsoft Defender for Cloud
description: Learn how to enable SQL vulnerability assessment on Azure SQL Database, Azure SQL Managed Instance, and Azure Synapse Analytics.
author: bmansheim
ms.author: benmansheim
ms.reviewer: wiassaf, vanto, mathoma
ms.date: 10/06/2022
ms.service: defender-for-cloud
ms.topic: how-to
ms.custom: sqldbrb=3
tags: azure-synapse
---

# Enable vulnerability assessment on your Azure SQL databases

In this article, you'll learn how to enable SQL vulnerability assessment so you can find and remediate database vulnerabilities. We recommend that you enable vulnerability assessment using the express configuration so you aren't dependent on a storage account, but you can also enable vulnerability assessment using the classic configuration.

Learn more about the [differences between the two configurations](defender-for-sql-azure-vulnerability-assessment-overview.md#what-are-the-express-and-classic-configurations).

## Prerequisites

- Make sure that [Microsoft Defender for Azure SQL](defender-for-databases-introduction.md) is enabled so that you can run scans on your Azure SQL databases.
- Make sure you read and understand the [differences between the express and classic configuration](defender-for-sql-azure-vulnerability-assessment-overview.md#whats-the-difference-between-the-express-and-classic-configuration).

## Enable vulnerability assessment

### [Express configuration (Preview)](#tab/express)

To enable vulnerability assessment without a storage account, use the express configuration:

1. Sign in to the [Azure portal](https://portal.azure.com/).
1. Open the specific Azure SQL Database resource. 
1. Under the Security heading, select **Defender for Cloud**.
1. Enable the express configuration of vulnerability assessment:
   
   > [!IMPORTANT]
   > Baselines and scan history are not migrated.
   
   - **If vulnerability assessment is not properly configured**, you are prompted to enable vulnerability assessment using the express configuration:

      image

      You see the same prompt if you select **Configure** on the link to open the Microsoft Defender for SQL settings pane for the entire server:

      image

      Select **Enable** to use the vulnerability assessment express configuration.

   - **If vulnerability assessment is already properly configured**, you are prompted to switch to express configuration: 

      image

      You see the same prompt if you select **Configure** on the link to open the Microsoft Defender for SQL settings pane for the entire server: 
 
      image

      Select **Enable** to use the vulnerability assessment express configuration and select **Confirm** to implement the change.

Go to the SQL databases should have vulnerability findings resolved recommendation to see the vulnerabilities found in your databases.

You can also run on-demand vulnerability assessment scans to see the current findings.

### Enable express vulnerability assessment at scale

Follow the instructions to enable the Microsoft Defender for SQL plan at the subscription level. 

If you enabled the plan at the subscription level after Express Configuration became available then all Azure SQL Servers under the selected subscription will have both Advanced Threat Protection and Vulnerability Assessment configured. 

Otherwise, no Azure SQL Servers, new or existing, will have VA automatically turned on with Express Configuration at this point.

### [Classic configuration](#tab/classic)

1. In the [Azure portal](https://portal.azure.com), open the specific resource in Azure SQL Database, SQL Managed Instance Database, or Azure Synapse.

1. Under the **Security** heading, select **Defender for Cloud**.

1. Select **Configure** on the link to open the Microsoft Defender for SQL settings pane for either the entire server or managed instance.

    :::image type="content" source="media/defender-for-sql-azure-vulnerability-assessment/opening-sql-configuration.png" alt-text="Opening the Defender for SQL configuration":::

    > [!NOTE]
    > SQL vulnerability assessment requires **Microsoft Defender for SQL** plan to be able to run scans. For more information about how to enable Microsoft Defender for SQL, see [Microsoft Defender for Azure SQL](defender-for-sql-introduction.md).

1. In the **Server settings** page, define the Microsoft Defender for SQL settings:

    :::image type="content" source="media/defender-for-sql-azure-vulnerability-assessment/sql-vulnerability-scan-settings.png" alt-text="Configuring the SQL vulnerability assessment scans":::

    1. Configure a storage account where your scan results for all databases on the server or managed instance will be stored. For information about storage accounts, see [About Azure storage accounts](/azure/storage/common/storage-account-create).

        > [!TIP]
        > For more information about storing vulnerability assessment scans behind firewalls and VNets, see [Store vulnerability assessment scan results in a storage account accessible behind firewalls and VNets](/azure/azure-sql/database/sql-database-vulnerability-assessment-storage.md).

    1. To configure vulnerability assessments to automatically run weekly scans to detect security misconfigurations, set **Periodic recurring scans** to **On**. The results are sent to the email addresses you provide in **Send scan reports to**. You can also send email notification to admins and subscription owners by enabling **Also send email notification to admins and subscription owners**.
    
       > [!NOTE] 
       > Each database is randomly assigned a scan time on a set day of the week. Email notifications are scheduled randomly per server on a set day of the week. The email notification report includes data from all recurring database scans that were executed during the preceding week (does not include on-demand scans).

## Next steps  

- Learn more about [Microsoft Defender for Azure SQL](defender-for-sql-introduction.md).
- Learn more about [data discovery and classification](/azure/azure-sql/database/data-discovery-and-classification-overview.md).
- Learn more about [Storing vulnerability assessment scan results in a storage account accessible behind firewalls and VNets](/azure/azure-sql/database/sql-database-vulnerability-assessment-storage.md).
