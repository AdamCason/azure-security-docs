---
title: Integrate ServiceNow with Microsoft Defender for Cloud
description: Learn about integrating ServiceNow with Microsoft Defender for Cloud to protect Azure, hybrid, and multicloud machines.
author: dcurwin
ms.author: justinha
ms.topic: how-to
ms.date: 10/23/2023
---

# Integrate ServiceNow with Microsoft Defender for Cloud

We're excited to introduce ServiceNow integration with Microsoft Defender for Cloud that will enable customers to 
connect ServiceNow to their Defender for Cloud environment. As part of this connection, you will be able to 
create/view ServiceNow tickets (linked to recommendations) from MDC. Through this Private Preview program we 
would love to hear your feedback on this integration.

## Common Use-Cases & Scenarios

ServiceNow Integration will enable customers using third party ticketing solutions (ServiceNow) to create, view
tickets (linked to recommendations) from Microsoft Defender for Cloud. 

## Preview Prerequisites

| Aspect | Details |
|--------|---------|
|Required/Preferred Environmental Requirements | - Have an application registry in Service Now. [Create a ServiceNow API Client ID and Client Secret for the SCOM ServiceNow Incident Connector (opslogix.com)](https://www.opslogix.com/knowledgebase/servicenow/kb-create-a-servicenow-api-key-and-secret-for-the-scom-servicenow-incident-connector) <br>- Defender Cloud Security Posture Management (DCSPM) enabled |
| Required Roles & Permissions | - Security Admin<br>- Contributor<br>- Owner |
| Clouds | &#x2705; Commercial Clouds<br> &#10060; Nation/Sovereign (US Gov, China Gov, Other Gov) |

## Onboarding to the Preview
Access to the private preview will be through this Feature Flag Link - https://aka.ms/integrations


## Onboarding ServiceNow to Defender for Cloud

### Create an application registry in ServiceNOW
As part of the onboarding process, you need to have a Client ID and ClientSecret of the ServiceNow instance 
for integrating to Defender for Cloud. If you don’t know/have ClientID and ClientSecret, follow the steps 
below for the same. 
a. In order to create the API Client ID and Client Secret you need to login to ServiceNow with an 
account which has sufficient permissions to modify the Application Registry.
b. Once you have logged in, browse to the ‘System OAuth’ section and click ‘Application Registry’ and 
click the ‘New’ button.
c. Select the option ‘Create an OAuth API endpoint for external clients.
d. Fill in the OAuth Client application details in this screen inorder to create ‘Client ID’ and ‘Client 
Secret.’
Name: A descriptive name in the Name field (MDCIntegrationSNOW in our example)
Client ID: Client ID will be automatically generated by ServiceNow OAuth server.
Client Secret: Enter a secret or the client secret can be left empty if you want it to be auto 
generated. This refers to the Client secret for the OAuth application.
Refresh Token lifespan: Time in seconds the Refresh token will be valid. 
Access Token lifespan: Time in seconds the Access token will be valid.

NOTE: The default value of RefreshToken Lifespan is too small, we recommend to increase the Token 
Lifespan to as maximum as possible to give it a long life so that you don’t need to refresh the token 
soon.

Click on the Submit button to save the API Client ID and Client Secret. (Refer example screenshot 
below) 
After you complete the steps above, you can use this user for integrating the instance to Microsoft 
Defender for Cloud.

### Create ServiceNow Integration with MDC

1. Use the following URL to login to Azure portal and navigate to Microsoft Defender for Cloud, Environment 
settings: https://aka.ms/integrations
1. Click on ‘Integrations’ to connect your environment to 3rd party ticketing system (ServiceNow in the current 
scenario)
1. Select ‘Add Integration’ and provide General information along with the ServiceNow information (Instance 
URL, Username, Password, ClientID, ClientSecret) that you generated in the previous exercise.
NOTE: You can create ‘Integration’ on (based on the relevant permissions): 
- Management group
- Subscription (API only, to reduce subscription level onboardings)
- Master connector
- Connector 
We recommend creating the integration on the higher scope based on the user permissions for ease. For example, if 
you have permission for a Management Group, you could create a single integration on a management group 
instead of creating integrations in each one of the subscriptions. 
1. Select and choose the ‘Default’ / ‘Customized’ option based on your requirement.

The default option will create Title, Description and Short description in the backend.
Customized option will let you choose additional fields like ‘Incident data’, ‘problems data’ and ‘Changes data’.

Clicking on the drop down, you’d notice by default the ‘Assigned to’, ‘caller’, ‘Short Description’ is grayed out because 
those are necessary fields, you’ll have options to choose more fields like ‘Assignment group’, ‘description’, ‘Impact’, 
‘Urgency’ for customized option.

Notice the successful creation of integration. 

You can review the integrations in ARG both on the individual integration or on all integrations. The toolbar on the 
Integrations page includes an ‘Open in ARG’ button to explore the details in [Azure Resource Graph (ARG)](/azure/governance/resource-graph/), an Azure 
service that gives you the ability to query – across multiple subscriptions.

## Create a new ticket from Microsoft Defender for Cloud recommendation to ServiceNow

- Security admins can now create and assign tickets directly from the Microsoft Defender for Cloud portal.
- Navigate to Microsoft Defender for Cloud > Recommendations > Select any recommendation with 
unhealthy resources that you want to create a ServiceNow ticket and assign an owner to 
- Click on the resource/s from the unhealthy resources and click on ‘Create Assignment.’

- When you click on ‘Create assignment’ a new context blade will appear to fill Assignment type and 
Assignment details. 
- Fill in the information below. 
  - Assignment Type – Choose ServiceNow from the dropdown.
  - Integration Instance – Select the Integration instance you want to assign this recommendation to.
  - ServiceNow ticket type – incident or change_request or problem.

NOTE: In ServiceNow, there are several types of tickets that can be used to manage and track different types of 
incidents, requests, and tasks. Only Incidents, Change Request and Problem are supported with this Integration. 

- To assign an affected recommendation to an owner who resides in ServiceNow, we provide new unified 
experience for all platforms. 
  Under Assignment details section, fill in the details below - 
  - Assigned to: Choose the owner you would like to assign the affected recommendation to 
  - Caller: Represents the user defining the assignment 
  - Description and Short Description: As part of the default selection in the earlier step, description 
and short description is automatically filled out 
  - Remediation timeframe: Choose the remediation timeframe to desired deadline the 
recommendation to be remediated. 
  - Apply Grace Period: You can apply grace period so that the resources that’s given a due date don’t 
affect your secure score until they’re overdue.
  - Set Email Notifications: Ability for additional notifications to the owners and/or owner’s direct 
manager as reminder


On a successful creation, you’d notice a Ticket ID assigned to this affected resource. The Ticket ID represents the 
ticket created in the ServiceNow portal.

Clicking on the Ticket ID will directly lead you to the ServiceNow portal, to the newly created incident.

NOTE: When integration is deleted, all the assignments will be deleted. It could take up to 24hrs. 
Assignment is resolved (as well as the task) when the assessment is resolved.
The background job will listen to the assessment changes, and in case assessment is resolved, the assignment in 
Microsoft Defender for Cloud will be deleted. In this case, the linked ticket will be resolved as well.