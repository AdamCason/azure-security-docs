---
title: Overview of Defender for Cosmos DB
description: Learn about the benefits and features of Microsoft Defender for Cosmos DB.
ms.topic: conceptual
ms.date: 02/01/2022
---

# Introduction

Microsoft Defender for Cosmos is an Azure-native layer of security intelligence that detects unusual and potentially harmful attempts to access or exploit your storage accounts. It uses advanced threat detection capabilities and [Microsoft Threat Intelligence](https://www.microsoft.com/insidetrack/microsoft-uses-threat-intelligence-to-protect-detect-and-respond-to-threats) data to provide contextual security alerts. Those alerts also include steps to mitigate the detected threats and prevent future attacks. 

You can enable protection for all your databases (recommended) or configure Microsoft Defender for Cosmos DB at either the subscription level or the resource level. 

Defender for Cosmos DB continually analyzes the telemetry stream generated by the Cosmos DB services.  
When potentially malicious activities are detected, security alerts are generated. These alerts are displayed in Microsoft Defender for Cloud together with the details of the suspicious activity along with the relevant investigation steps, remediation actions, and security recommendations. 

Defender for Cosmos DB doesn't access the Cosmos DB account data and does not have any impact on its performance. 

## Availability

|Aspect|Details|
|----|:----|
|Release state:| Public Preview (PP) |
|Protected Cosmos DB API | - SQL/Core API <br> - Cassandra API <br> - MongoDB API <br> - Table API <br> - Gremlin API |
|Clouds:|:::image type="icon" source="./media/icons/yes-icon.png"::: Commercial clouds<br>:::image type="icon" source="./media/icons/no-icon.png"::: Azure Government <br>:::image type="icon" source="./media/icons/no-icon.png"::: Azure China 21Vianet <br>:::image type="icon" source="./media/icons/no-icon.png"::: Connected AWS accounts |

## Benefits of Defender for Cosmos DB

Using advanced threat detection capabilities and Microsoft Threat Intelligence data, Defender for Cosmos DB continuously monitors your Cosmos DB accounts for threats such as SQL injection, compromised identities and data exfiltration. 

This service provides action-oriented security alerts in Microsoft Defender for Cloud with details of the suspicious activity and guidance on how to mitigate the threats. 
You can use this information to quickly remediate security issues and improve the security of your Cosmos DB accounts. 

Alerts include details of the incident that triggered them, and recommendations on how to investigate and remediate threats. Alerts can be exported to Microsoft Sentinel or any other third-party SIEM or any other external tool. To learn how to stream alerts, see [Stream alerts to a SIEM, SOAR, or IT Service Management solution](export-to-siem.md). 

> [!TIP]
> For a comprehensive list of all Defender for Storage alerts, see the [alerts reference page](alerts-reference.md#alerts-azurestorage). This is useful for workload owners who want to know what threats can be detected and help SOC teams gain familiarity with detections before investigating them. Learn more about what's in a Defender for Cloud security alert, and how to manage your alerts in [Manage and respond to security alerts in Microsoft Defender for Cloud](managing-and-responding-alerts.md).

## Alert types

Threat intelligence security alerts are triggered upon: 

- Potential SQL injection attacks: Due to the structure and capabilities of Cosmos DB queries, many known SQL injection attacks cannot work in Cosmos DB. However, there are some variations of SQL injections that can succeed and may result in exfiltrating data from your Cosmos DB accounts. Defender for Cosmos DB detects both successful and failed attempts, and helps you harden your environment to prevent these threats. 
 
- Anomalous database access patterns: For example, access from a TOR exit node, known suspicious IP addresses, unusual applications, and unusual locations. 
 
- Suspicious database activity: For example, suspicious key-listing patterns that resemble know malicious lateral movement techniques and suspicious data extraction patterns. 

## Next steps

Learn how to [Enable Microsoft Defender for Cosmos](quickstart-enable-defender-for-cosmos.md)
