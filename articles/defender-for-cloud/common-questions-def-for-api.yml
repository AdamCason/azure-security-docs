### YamlMime:FAQ
metadata:
  title: Common Questions - Defender for APIs Troubleshooting Guide
  description: Common Questions - Defender for APIs Troubleshooting Guide FAQ
  author: alizabernstein
  ms.author: alizabernstein
  ms.service: 
  ms.topic: faq
  ms.date: 06/05/2023
title: Common Questions - Defender for APIs troubleshooting guide

## Common questions for Defender for APIs

sections:
  - name: Availability and Onboarding
    questions:
      - question: What type of APIs can I secure using Defender for APIs?
        answer: Currently, Defender for APIs supports REST APIs only.
          
      - question: Is Defender for APIs available in my region?
        answer: Review the list of supported regions in [Defender for APIs Benefits and Features](https://learn.microsoft.com/azure/defender-for-cloud/defender-for-apis-introduction).

      - question: Are there any pricing and business models associated with the Defender for APIs plan?
        answer: No, Defender for APIs is free to use in Public Preview.

      - question: I’m getting an error while onboarding APIs to Defender for APIs from the Recommendations page.
        answer: If you encounter errors like "Access Denied", "Forbidden", "Role Assignment not found", or "Authorization Failed", ensure that you have the right level of permission for the Azure API Management service and Microsoft Defender for Cloud. Required set of permissions can be found [here](https://learn.microsoft.com/azure/defender-for-cloud/defender-for-apis-introduction). 
                The error "Request Header or Cookie Too Large" can typically be fixed by clearing all cookies; clear your browser cookies and try the operation again.

      - question: Does onboarding APIs to Defender for APIs affect my Azure API Management service?
        answer: Enabling Defender for APIs monitoring coverage requires compute & memory utilization on the Azure API Management service. Monitor the performance of your Azure API Management service while onboarding APIs and scale out your Azure API Management resources when needed.

      - question: I use Azure API Management Consumption tier offering. Can I use Defender for APIs?
        answer: No, support for Azure API Management consumption tier is currently not available.

      - question: I enabled the Defender for APIs plan on the Defender plans page of Microsoft Defender for Cloud. How do I see security findings for my APIs in Azure API Management?
        answer: Onboarding APIs from Azure API Management to Defender for APIs is a two step process; first, enable the Defender for APIs plan for a subscription; then onboard unprotected APIs to Defender for APIs. Follow the instructions in the [Quickstart Guide](https://aka.ms/apiSecurityOnboarding) to complete the onboarding steps.
  
  - name: Questions related to region/geo 
    questions:
      - question: Does Defender for APIs move API traffic data out of my region/geo?
        answer: Defender for APIs doesn't move API traffic out of customer’s region or geo. All the data processed will always remain within the customer onboarded geo. In terms of data retention, Defender for APIs doesn't store API payloads for more than 48 hours.

      - question: I just moved my APIs within my Azure API Management service to a new region. Why are these not updated?
        answer: APIs that are moved from one region to another region require [offboarding](defender-for-apis-manage.md#offboard-an-api) and [onboarding](defender-for-apis-deploy.md) of the APIs.

      - question: How do I enable Defender for APIs plan for a specific set of Azure API Management services?
        answer: Microsoft Defender for APIs plan is enabled at the subscription level. You can select which APIs in Azure API Management from that subscription are onboarded for security coverage. 

      - question: I onboarded APIs from Azure API Management to Defender for APIs, but they're still showing under unhealthy resources on the recommendation page / I don't see any security insights for the APIs I onboarded.
        answer: Defender for APIs will take 30 minutes to generate the first security insights after onboarding an API and to move the onboarded APIs from unhealthy to healthy status. Thereafter, security insights are refreshed every 30 minutes
      
      - question: Why do security insights within the API collection details page show as "Awaiting Data"?
        answer: API endpoints that have received no traffic since onboarding to Defender for APIs display the message ‘Awaiting data’ under security insights. Until the API endpoint receives traffic, the security insight assessment can't be made.
    
      - question: I have a self-hosted Azure API Management gateway. Can I use Defender for APIs for securing my APIs?
        answer: Currently Defender for APIs support is limited to the cloud hosted instances of Azure API Management gateways only.

      - question: My Azure API Management service is in a VNet. Do I need to have additional connectivity configured for Defender for APIs?
        answer: No, Defender for APIs won't need special configuration for accessing API data from Azure API Management service behind a VNET.

      - question: What is the IP address shown in Defender for APIs alerts description page if x-forwarded-for is configured within our network? 
        answer: Defender for APIs shows the IP address of the inbound IP address from client IPs. If x-forwarded-for is used, Defender for APIs validates the IP hops as part of the x-forwarded-for used within the request to show the most accurate IP that inbound request is coming from. 
    
      - question: We use custom domain URL within Azure API Management, will Defender for APIs show this URL as the Endpoint URL?
        answer: Custom domain URLs aren't shown within the Endpoint URL. The Defender for APIs Endpoint URL shows the base URL of your API Management API endpoint

  - name: Questions about alerts in Defender for APIs 
    questions:
      - question: How soon can we receive alerts on anomalous APIs? 
        answer: APIs are assessed against their behavior studying traffic for the past 30 days. The alerts on anomalous APIs may be generated sooner if the API receives significant traffic for the ML models to learn traffic behavior. 
     
      - question: How do I see some alerts for Defender for APIs? 
        answer: You can use the Sample alerts functionality on the Security alerts page of Microsoft Defender for Cloud to get a quick overview of Defender for APIs alerts and how they operate. You can also use an [alert simulator](defender-for-apis-validation.md#simulate-an-alert) to test our rule-based detections.

      - question: How do I offboard APIs from Defender for APIs? 
        answer: Follow the instructions for [offboarding](defender-for-apis-manage.md#offboard-an-api) to remove APIs one at a time from Defender for APIs. 


