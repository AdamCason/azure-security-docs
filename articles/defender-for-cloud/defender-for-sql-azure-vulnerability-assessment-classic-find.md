---
title: Find vulnerabilities in your Azure SQL databases with a storage account using Microsoft Defender for Cloud
description: Learn how to find software vulnerabilities with the classic configuration on Azure SQL Database, Azure SQL Managed Instance, and Azure Synapse Analytics.
author: bmansheim
ms.author: benmansheim
ms.reviewer: wiassaf, vanto, mathoma
ms.date: 10/06/2022
ms.service: defender-for-cloud
ms.topic: how-to
ms.custom: sqldbrb=3
tags: azure-synapse
---

# Find vulnerabilities in your Azure SQL databases with a storage account (Classic)

## Permissions

One of the following permissions is required to see vulnerability assessment results in the Microsoft Defender for Cloud recommendation **SQL databases should have vulnerability findings resolved**:
- Security Admin
- Security Reader

The following permissions are required to changes vulnerability assessment settings:

- SQL Security Manager
- Storage Blob Data Reader
- Owner role on the storage account

The following permissions are required to open links in email notifications about scan results or to view scan results at the resource-level:

- SQL Security Manager
- Storage Blob Data Reader

## Data residency

SQL vulnerability assessment queries the SQL server using publicly available queries under Defender for Cloud recommendations for SQL vulnerability assessment, and stores the query results. The data is stored in the configured user-owned storage account. 

SQL vulnerability assessment allows you to specify the region where your data will be stored by choosing the location of the storage account. The user is responsible for the security and data resiliency of the storage account.

## Run on-demand vulnerability scans

SQL vulnerability assessment scans can also be run on-demand: 

From the resource's Defender for Cloud page, select View additional findings in vulnerability assessment to access the scan results from previous scans. 

To run an on-demand scan to scan your database for vulnerabilities, select Scan from the toolbar: 

## Run on-demand scans

1. SQL vulnerability assessment scans can also be run on-demand:

    1. From the resource's **Defender for Cloud** page, select **View additional findings in Vulnerability Assessment** to access the scan results from previous scans.

        :::image type="content" source="media/defender-for-sql-azure-vulnerability-assessment/view-additional-findings-link.png" alt-text="Opening the scan results and manual scan options.":::

    1. To run an on-demand scan to scan your database for vulnerabilities, select **Scan** from the toolbar:

        :::image type="content" source="media/defender-for-sql-azure-vulnerability-assessment/on-demand-vulnerability-scan.png" alt-text="Select scan to run an on-demand vulnerability assessment scan of your SQL resource":::


  > [!NOTE]
  > The scan is lightweight and safe. It takes a few seconds to run and is entirely read-only. It doesn't make any changes to your database.

## Remediate vulnerabilities

When a vulnerability scan completes, the report is displayed in the Azure portal. The report presents:

- An overview of your security state
- The number of issues that were found
- A summary by severity of the risks
- A list of the findings for further investigations

:::image type="content" source="media/defender-for-sql-azure-vulnerability-assessment/sample-sql-vulnerabilities-report.png" alt-text="Sampl scan report from the SQL vulnerability assessment scanner":::

To remediate the vulnerabilities discovered:

1. Review your results and determine which of the report's findings are true security issues for your environment.

1. Select each failed result to understand its impact and why the security check failed.

    > [!TIP]
    > The findings details page includes actionable remediation information explaining how to resolve the issue.

    :::image type="content" source="media/defender-for-sql-azure-vulnerability-assessment/examining-vulnerability-findings.gif" alt-text="Examining the findings from a vulnerability scan":::

1. As you review your assessment results, you can mark specific results as being an acceptable *baseline* in your environment. A baseline is essentially a customization of how the results are reported. In subsequent scans, results that match the baseline are considered as passes. After you've established your baseline security state, vulnerability assessment only reports on deviations from the baseline. In this way, you can focus your attention on the relevant issues.

    :::image type="content" source="media/defender-for-sql-azure-vulnerability-assessment/baseline-approval.png" alt-text="Approving a finding as a baseline for future scans":::

1. If you change the baselines, use the **Scan** button to run an on-demand scan and view the customized report. Any findings you've added to the baseline will now appear in **Passed** with an indication that they've passed because of the baseline changes.

    :::image type="content" source="media/defender-for-sql-azure-vulnerability-assessment/passed-per-custom-baseline.png" alt-text="Passed assessments indicating they've passed per custom baseline":::

Your vulnerability assessment scans can now be used to ensure that your database maintains a high level of security, and that your organizational policies are met.

## Next steps  

- Learn more about [Microsoft Defender for Azure SQL](defender-for-sql-introduction.md).
- Learn more about [data discovery and classification](/azure/azure-sql/database/data-discovery-and-classification-overview.md).
- Learn more about [Storing vulnerability assessment scan results in a storage account accessible behind firewalls and VNets](/azure/azure-sql/database/sql-database-vulnerability-assessment-storage.md).
