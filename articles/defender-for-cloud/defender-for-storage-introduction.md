---
title: Microsoft Defender for Storage - the benefits and features
titleSuffix: Microsoft Defender for Cloud
description: Learn about the benefits and features of Microsoft Defender for Storage.
ms.date: 03/23/2023
author: bmansheim
ms.author: benmansheim
ms.topic: overview
---

# Overview of Microsoft Defender for Storage

**Microsoft Defender for Storage** is an Azure-native layer of security intelligence that detects unusual and potentially harmful attempts to access or exploit your storage accounts. It provides comprehensive security by analyzing the data plane and control plane telemetry generated by [Azure Blob Storage](https://azure.microsoft.com/services/storage/blobs/), [Azure Files](https://azure.microsoft.com/products/storage/files/), and [Azure Data Lake Storage](https://azure.microsoft.com/products/storage/data-lake-storage) services. Defender for Storage uses advanced threat detection capabilities powered by [Microsoft Threat Intelligence](https://go.microsoft.com/fwlink/?linkid=2128684),  [Microsoft Antimalware](/azure/security/fundamentals/antimalware), and [sensitive data discovery](concept-data-security-posture.md) to help you discover and mitigate potential threats.

The Defender for Storage includes advanced security capabilities and a pricing plan to help you effectively secure your data at scale.

> [!NOTE]
> If you already have the Defender for Storage (classic) enabled and want to access the new security features and pricing, you'll need to [migrate to the new pricing plan](link).

## Advanced security capabilities

The capabilities of Defender for Storage help prevent malicious file uploads, sensitive data exfiltration, and data corruption, which are the primary risks to your data and workloads.

The capabilities include the following: 

- **Malware scanning**: Scans uploaded blobs for malware in near-real time, providing fast and reliable results consumable in several ways to help you prevent your storage account from becoming a point of entry and distribution for threats. The Malware Scanning capability is agentless and offers easy setup at scale. It scans all file types, including archives, and is powered by Microsoft Defender Antivirus technology.

[Malware Scanning GIF/vid]

- **Sensitive data threat detection**: Leveraging Microsoft Defender for Cloud's Sensitive Data Discovery to simplify security threats identification, investigation, and triage by providing contextual sensitivity information in security alerts about compromised storage accounts. The Sensitive Data Discovery capability is agentless and scans for sensitive information in managed cloud data resources using a smart sampling scanning method aligned with Microsoft Purview's sensitive information types and classification labels.

- **Detection of entities without identities**: Defender for Storage detects suspicious activities generated by entities without identities that access your data using misconfigured and overly permissive Shared Access Signatures (SAS tokens) that may have leaked or compromised so that you can improve the security hygiene and reduce the risk of unauthorized access. This capability is an expansion of the security alerts suite.

:::image type="content" source="media/defender-for-storage-introduction/defender-for-storage-overview.png" alt-text="Diagram showing the capabilities of Defender for Storage.":::

## Pricing plan

Microsoft Defender for Storage offers a predictable pricing plan based on the number of storage accounts you protect. With the option to enable at the subscription or resource level and to exclude specific storage accounts from protected subscriptions, you have increased flexibility to manage your security coverage. The pricing plan simplifies the cost calculation process, allowing you to scale easily as your needs change. Additional charges may apply to storage accounts with high-volume transactions.

## Getting started

With a simple agentless setup at scale, you can enable Defender for Storage at the subscription or resource levels through the portal or programmatically. When enabled at the subscription level, all existing and newly created storage accounts under that subscription will be automatically protected. You can also exclude specific storage accounts from protected subscriptions. 

## Availability

|Aspect|Details|
|----|:----|
|Release state:|General availability (GA)|
|Feature availability:|- Activity monitoring (security alerts) - General availability (GA)<br>- Malware Scanning – Preview<br>- Sensitive data threat detection (Sensitive Data Discovery) – Preview|
|Pricing:|- Defender for Storage: $10/storage accounts/month\*<br>- Malware Scanning (add-on): Free during public preview\*\*<br><br>Above pricing applies to commercial clouds. Visit the [pricing page](https://azure.microsoft.com/pricing/details/defender-for-cloud/) to learn more.<br><br>\* Storage accounts that exceed 73 million monthly transactions will be charged $0.1492 for every 1 million transactions that exceed the threshold.<br>\*\* In the future, Malware Scanning will be priced at $0.15/GB of data ingested. Billing for Malware Scanning is not enabled during public preview and advanced notice will be given before billing starts.|
| Supported storage types:|[Blob Storage](https://azure.microsoft.com/en-us/products/storage/blobs/) (Standard/Premium StorageV2, including Data Lake Gen2): Activity monitoring, Malware Scanning, Sensitive Data Discovery<br>Azure Files (over REST API and SMB): Activity monitoring |
|Required roles and permissions:|For Malware Scanning and sensitive data threat detection at subscription and storage account levels, you need Owner roles (subscription owner/storage account owner) or specific roles with corresponding data actions. To enable Activity Monitoring, you need 'Security Admin' permissions. Read more about the required permissions.|
|Clouds:|:::image type="icon" source="../defender-for-cloud/media/icons/yes-icon.png"::: Commercial clouds\*<br>:::image type="icon" source="../defender-for-cloud/media/icons/yes-icon.png"::: Azure Government (Only for activity monitoring)<br>:::image type="icon" source="../defender-for-cloud/media/icons/no-icon.png"::: Azure China 21Vianet<br>:::image type="icon" source="../defender-for-cloud/media/icons/no-icon.png"::: Connected AWS accounts|

\* Azure DNS Zone is not supported for Malware Scanning and sensitive data threat detection.

## What are the benefits of Microsoft Defender for Storage?

Defender for Storage provides:

- **Better protection against malware**: The Malware Scanning scans and detects in near real-time all file types, including archives of every uploaded blob. The scan provides fast and reliable results, helping you prevent your storage accounts from acting as an entry and distribution point for threats. Learn more about [Malware Scanning](link).

- **Improved threat detection and protection of sensitive data**: Lets you efficiently prioritize and examine security alerts by considering the sensitivity of the data that could be at risk for better detection and protection against potential threats. By quickly identifying and addressing the most significant risks, this capability lowers the likelihood of data breaches and enhances sensitive data protection by detecting exposure events and suspicious activities on resources containing sensitive data. Learn more about [data sensitivity scanning](link).

- **Detection of entities without identities**: Detects compromised and misconfigured authentication tokens that allow access to the data plane to help prevent unauthorized access to your storage accounts and improve the overall security of your data.

- **Coverage of the top cloud storage threats** - Detect unusual and suspicious activities based on Microsoft Threat Intelligence, behavioral models, and machine learning models. The Defender for Storage security alerts cover the top cloud storage threats, such as sensitive data exfiltration, data corruption, and malicious file uploads.

- **Comprehensive security without enabling logs**: Continuously analyzes both the data plane and control plane telemetry stream generated by Azure Blob Storage, Azure Files, and Azure Data Lake Storage services without requiring diagnostic logs.

- **Frictionless enablement at scale**: An agentless solution that is easy to deploy and provides security protection at scale using a one-click, Azure-native solution.

## How does the service work?

### Activity monitoring 

Defender for Storage constantly analyzes data and control plane logs from protected storage accounts when enabled. There's no need to turn on resource logs for security benefits. Using Microsoft Threat Intelligence, it identifies suspicious signatures such as malicious IP addresses, Tor exit nodes, and potentially dangerous apps. It also builds data models and uses statistical and machine-learning methods to spot baseline activity anomalies, which may indicate malicious behavior. You'll receive security alerts for suspicious activities, but Defender for Storage ensures you won't get too many similar alerts. Activity monitoring won't affect performance, ingestion capacity, or access your data.

### Malware Scanning

Malware Scanning safeguards your blob storage accounts from becoming entry and distribution points for malware in your organization and downstream consumers. It scans every uploaded blob, regardless of upload method, using the regional Malware Scanning service powered by the Microsoft Antimalware engine. After scanning, you can access the results through index-tags, event-grid events, log analytics, or high-severity MDC alerts for malicious blobs found. Learn more about [Malware Scanning](link).

### Sensitive data threat detection (Sensitive Data Discovery) 

Sensitive data threat detection finds sensitive information in managed cloud data resources. This agentless feature uses a smart sampling method in line with Microsoft Purview's sensitive information types and classification labels. You must enable this feature when turning on Microsoft Defender for Storage. Once enabled, it scans your blob containers for sensitive information, which will be displayed in security alerts sent on resources with sensitive data.

## Common questions

- Is it possible to enable Defender for Storage on a resource level?

    Yes, it's possible to enable Defender for Storage at the resource level and set up Malware Scanning and Sensitivity Scanning accordingly. Keep in mind that enabling it at the subscription level is the recommended approach, as it will automatically protect all new storage accounts. 

- Can I exclude certain storage accounts from protection?

    Yes, you can exclude storage accounts from protection.

- How long does it take for subscription-level enablement to take effect?

    Enabling Defender for Storage at the subscription level may take up to 24 hours to be fully enabled across all storage accounts. 

- Is there a difference in features between the new and Defender for Storage (classic)?

    Yes, there is a difference in the capabilities of the two plans. New and future security capabilities will only be available in the new Defender for Storage plan. If you want to access these new capabilities, you'll need to enable the new plan.

- Can I switch back to the Defender for Storage (classic)?

    Yes, using the REST API, you can return to using the Defender for Storage (classic).

- Will the Defender for Storage (classic) continue to be supported?

    The Defender for Storage (classic) will still continue to be supported for three years after the release of the new Defender for Storage to general availability (GA). 

- How can I calculate the cost of each plan?

    To estimate the cost of Defender for Storage, we've provided a pricing estimation workbook and a PowerShell script that you can run in your environment.

## Next steps

In this article, you learned about Microsoft Defender for Storage. 

> [!div class="nextstepaction"]
> [Enable Defender for Storage](enable-enhanced-security.md)
